version: 1.0

groups:
  setup:
    tasks:
      create-folders:
        run: |
          mkdir -p /tmp/target1
          mkdir -p /tmp/target2
          mkdir -p /tmp/group-absolute/target1
          mkdir -p /tmp/group-relative/target1

  group-no-path:
    tasks:
      task-no-path:
        help: Test global no-path, group no-path, task no-path
        dependencies:
          - task: setup.create-folders
        run: |
          import os
          echo f"{os.getcwd()}"
          echo "working-directory-no-path [I] Done!"

      task-absolute:
        working-directory: "/tmp/target1"
        help: Test global no-path, group no-path, task absolute
        dependencies:
          - task: setup.create-folders
        run: |
          import os
          assert os.getcwd() == "/tmp/target1"
          echo "working-directory-no-path [II] Done!"

      task-relative:
        working-directory: "target2"
        help: Test global no-path, group no-path, task relative
        dependencies:
          - task: setup.create-folders
        run: |
          import os
          assert os.getcwd() == "/tmp/target2"
          echo "working-directory-no-path [III] Done!"

  group-absolute:
    working-directory: "/tmp/group-absolute"
    tasks:
      task-no-path:
        help: Test global no-path, group absolute path, task no-path
        dependencies:
          - task: setup.create-folders
        run: |
          import os
          assert os.getcwd() == "/tmp/group-absolute"
          echo "working-directory-no-path [IV] Done!"

      task-absolute:
        working-directory: /tmp/target1
        help: Test global no-path, group absolute path, task absolute path
        dependencies:
          - task: setup.create-folders
        run: |
          import os
          assert os.getcwd() == "/tmp/target1"
          echo "working-directory-no-path [V] Done!"

      task-relative:
        working-directory: "target1"
        help: Test global no-path, group absolute path, task relative path
        dependencies:
          - task: setup.create-folders
        run: |
          import os
          assert os.getcwd() == "/tmp/group-absolute/target1"
          echo "working-directory-no-path [VI] Done!"

  group-relative:
    working-directory: "group-relative"
    tasks:
      task-no-path:
        help: Test global no-path, group relative path, task no-path
        dependencies:
          - task: setup.create-folders
        run: |
          import os
          assert os.getcwd() == "/tmp/group-relative"
          echo "working-directory-no-path [VII] Done!"

      task-absolute:
        working-directory: "/tmp/target2"
        help: Test global no-path, group relative path, task absolute path
        dependencies:
          - task: setup.create-folders
        run: |
          import os
          assert os.getcwd() == "/tmp/target2"
          echo "working-directory-no-path [VIII] Done!"

      task-relative:
        working-directory: "target1"
        help: Test global no-path, group relative path, task relative path
        dependencies:
          - task: setup.create-folders
        run: |
          import os
          assert os.getcwd() == "/tmp/group-relative/target1"
          echo "working-directory-no-path [IX] Done!"
